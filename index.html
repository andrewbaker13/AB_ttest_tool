<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welch's t-test Tool</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <header>
        <h1>Welch's t-test Tool</h1>
        <p>Compare means of two independent groups with fan charts and narrative insights</p>
    </header>

    <main>
        <section class="equation-section">
            <h2>Key Equations</h2>
            <p>The Welch's t-test evaluates whether two independent group means differ using the statistic:</p>
            <p>\[ t = \frac{\bar{x}_1 - \bar{x}_2 - \Delta_0}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}} \]</p>
            <p>The confidence interval for the difference in means is computed as:</p>
            <p>\[ (\bar{x}_1 - \bar{x}_2) \pm t_{\alpha/2,\,\nu} \times \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}} \]</p>
            <div class="equation-note">
                <h3>When does Welch's t behave like a z-test?</h3>
                <p>
                    As the degrees of freedom grow large—typically when both sample sizes exceed 30 and neither variance is
                    extremely dominant—the t distribution rapidly approaches the standard normal distribution. In those
                    situations, the Welch statistic mirrors a z-test because the additional uncertainty from estimating the
                    variances becomes negligible. When sample sizes are smaller or highly imbalanced, the heavier tails of the t
                    distribution remain critical for keeping the Type I error rate in check.
                </p>
                <p>
                    For a deeper discussion of the transition from t to z under large-sample conditions, see the
                    <a href="https://en.wikipedia.org/wiki/Welch%27s_t-test#Relation_to_normal_distribution" target="_blank" rel="noopener noreferrer">
                        Welch's t-test article on Wikipedia
                    </a>.
                </p>
            </div>
        </section>

        <section class="scenario-section">
            <h2>Practical Scenario</h2>
            <p>
                Imagine comparing the average outcomes for
                <span id="scenario-group1">Group 1</span> and
                <span id="scenario-group2">Group 2</span>. Adjust the inputs below to reflect
                your real-world experiment, and this tool will quantify how different the group means are.
            </p>
        </section>

        <section class="input-section">
            <div class="group-inputs">
                <h2 id="group1-heading">Group 1</h2>
                <div class="input-group">
                    <label for="group1-name">Group 1 Name:</label>
                    <input type="text" id="group1-name" value="Group 1" maxlength="40">
                </div>
                <div class="input-group">
                    <label for="mean1">Mean (x̄₁):</label>
                    <input type="number" id="mean1" step="any" required>
                </div>
                <div class="input-group">
                    <label for="sd1">Standard Deviation (s₁):</label>
                    <input type="number" id="sd1" step="any" min="0" required>
                </div>
                <div class="input-group">
                    <label for="n1">Sample Size (n₁):</label>
                    <input type="number" id="n1" step="1" min="2" required>
                </div>
            </div>

            <div class="group-inputs">
                <h2 id="group2-heading">Group 2</h2>
                <div class="input-group">
                    <label for="group2-name">Group 2 Name:</label>
                    <input type="text" id="group2-name" value="Group 2" maxlength="40">
                </div>
                <div class="input-group">
                    <label for="mean2">Mean (x̄₂):</label>
                    <input type="number" id="mean2" step="any" required>
                </div>
                <div class="input-group">
                    <label for="sd2">Standard Deviation (s₂):</label>
                    <input type="number" id="sd2" step="any" min="0" required>
                </div>
                <div class="input-group">
                    <label for="n2">Sample Size (n₂):</label>
                    <input type="number" id="n2" step="1" min="2" required>
                </div>
            </div>

            <div class="test-options">
                <h2>Test Options</h2>
                <div class="input-group">
                    <label for="delta0">Hypothesized Difference (Δ₀):</label>
                    <input type="number" id="delta0" step="any" value="0">
                </div>
                <div class="confidence-buttons">
                    <label>Confidence Level:</label>
                    <div class="button-group" role="group" aria-label="Select confidence level">
                        <button class="conf-level-btn" data-level="0.90">90%</button>
                        <button class="conf-level-btn selected" data-level="0.95">95%</button>
                        <button class="conf-level-btn" data-level="0.99">99%</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="results-section">
            <div class="visualization-wrapper">
                <article class="chart-card" aria-labelledby="means-chart-title">
                    <h2 id="means-chart-title">Means Fan Chart</h2>
                    <div id="means-chart" class="plot-container" role="img" aria-live="polite" aria-label="Fan chart showing group means and confidence intervals"></div>
                    <div id="means-narrative" class="chart-narrative" aria-live="polite"></div>
                </article>
                <article class="chart-card" aria-labelledby="diff-chart-title">
                    <h2 id="diff-chart-title">Difference Fan Chart</h2>
                    <div id="difference-chart" class="plot-container" role="img" aria-live="polite" aria-label="Fan chart showing difference in means and confidence intervals"></div>
                    <div id="difference-narrative" class="chart-narrative" aria-live="polite"></div>
                </article>
            </div>

            <section class="axis-settings" aria-label="Chart Axis Settings">
                <h2>Chart Axis Settings</h2>
                <div class="axis-card">
                    <h3>Means Fan Chart</h3>
                    <label class="switch-label">
                        <input type="checkbox" id="means-axis-lock">
                        <span>Lock axis to custom range</span>
                    </label>
                    <div class="range-inputs">
                        <div class="input-group inline">
                            <label for="means-axis-min">Min:</label>
                            <input type="number" id="means-axis-min" step="any">
                        </div>
                        <div class="input-group inline">
                            <label for="means-axis-max">Max:</label>
                            <input type="number" id="means-axis-max" step="any">
                        </div>
                    </div>
                </div>
                <div class="axis-card">
                    <h3>Difference Fan Chart</h3>
                    <fieldset>
                        <legend>Axis Mode</legend>
                        <label class="radio-label">
                            <input type="radio" name="diff-axis-mode" value="auto" checked>
                            <span>Auto scale</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="diff-axis-mode" value="symmetric">
                            <span>Symmetric ±</span>
                        </label>
                        <div class="input-group inline">
                            <label for="diff-axis-symmetric">Bound:</label>
                            <input type="number" id="diff-axis-symmetric" step="any">
                        </div>
                        <label class="radio-label">
                            <input type="radio" name="diff-axis-mode" value="custom">
                            <span>Custom range</span>
                        </label>
                        <div class="range-inputs">
                            <div class="input-group inline">
                                <label for="diff-axis-min">Min:</label>
                                <input type="number" id="diff-axis-min" step="any">
                            </div>
                            <div class="input-group inline">
                                <label for="diff-axis-max">Max:</label>
                                <input type="number" id="diff-axis-max" step="any">
                            </div>
                        </div>
                    </fieldset>
                    <button id="reset-axis" type="button" class="secondary">Reset Axis Controls</button>
                </div>
            </section>

            <div id="interpretation" class="interpretation" aria-live="polite"></div>

            <section class="summary-section" aria-live="polite">
                <h2>Summary of Estimates</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Measure</th>
                            <th>Estimate</th>
                            <th>Standard Error</th>
                            <th id="summary-ci-header">Confidence Interval</th>
                        </tr>
                    </thead>
                    <tbody id="summary-table-body"></tbody>
                </table>
            </section>
        </section>

        <section class="critical-thinking">
            <h2>Critical Thinking Questions</h2>
            <ul>
                <li>Under what conditions would you prioritize practical significance over statistical significance in deciding next steps?</li>
                <li>How might unequal variances influence strategic recommendations even when the null hypothesis is not rejected?</li>
                <li>What additional data would you gather to validate these findings before committing resources to a new initiative?</li>
            </ul>
        </section>
    </main>

    <footer>
        <p>Created: <span id="created-date"></span> | Last modified: <span id="modified-date"></span></p>
    </footer>

    <script src="app.js"></script>
</body>
</html>
